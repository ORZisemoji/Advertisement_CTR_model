label:[0 1]
0    40461645
1     1445488
Name: label, dtype: int64
-------------------------
0    0.965507
1    0.034493
Name: label, dtype: float64
/home/mengyuan/huawei/catbase.py:72: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version
of pandas will change to not sort by default.

To accept the future behavior, pass 'sort=False'.

To retain the current behavior and silence the warning, pass 'sort=True'.

  df = pd.concat([train_df,test_df],axis=0)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.74it/s] 14%|█▍        | 2/14 [00:00<00:02,  5.21it/s] 21%|██▏       | 3/14 [00:00<00:02,  5.45it/s] 29%|██▊       | 4/14 [00:00<00:01,  5.65it/s] 36%|███▌      | 5/14 [00:00<00:01,  5.91it/s] 43%|████▎     | 6/14 [00:00<00:01,  5.99it/s] 50%|█████     | 7/14 [00:01<00:01,  6.19it/s] 57%|█████▋    | 8/14 [00:01<00:00,  6.44it/s] 64%|██████▍   | 9/14 [00:01<00:00,  6.46it/s] 71%|███████▏  | 10/14 [00:01<00:00,  6.56it/s] 79%|███████▊  | 11/14 [00:01<00:00,  6.61it/s] 86%|████████▌ | 12/14 [00:02<00:00,  2.61it/s] 93%|█████████▎| 13/14 [00:02<00:00,  3.04it/s]100%|██████████| 14/14 [00:03<00:00,  3.66it/s]
-- Mem. usage decreased to 584.13 Mb (71.6% reduction),time spend:0.07 min
  0%|          | 0/4 [00:00<?, ?it/s]**************************task_id**************************
**************************adv_id**************************
**************************dev_id**************************
**************************slot_id**************************
**************************spread_app_id**************************
**************************indu_name**************************
 25%|██▌       | 1/4 [00:41<02:03, 41.28s/it]**************************task_id**************************
**************************adv_id**************************
**************************dev_id**************************
**************************slot_id**************************
**************************spread_app_id**************************
**************************indu_name**************************
 50%|█████     | 2/4 [01:09<01:15, 37.51s/it]**************************task_id**************************
**************************adv_id**************************
**************************dev_id**************************
**************************slot_id**************************
**************************spread_app_id**************************
**************************indu_name**************************
 75%|███████▌  | 3/4 [01:38<00:34, 34.94s/it]**************************task_id**************************
**************************adv_id**************************
**************************dev_id**************************
**************************slot_id**************************
**************************spread_app_id**************************
**************************indu_name**************************
100%|██████████| 4/4 [02:07<00:00, 33.11s/it]
['uidtask_id_nunique', 'uidadv_id_nunique', 'uiddev_id_nunique', 'uidslot_id_nunique', 'uidspread_app_id_nunique', 'uidindu_name_nunique', 'agetask_id_nunique', 'ageadv_id_nunique', 'agedev_id_nunique', 'ageslot_id_nunique', 'agespread_app_id_nunique', 'ageindu_name_nunique', 'careertask_id_nunique', 'careeradv_id_nunique', 'careerdev_id_nunique', 'careerslot_id_nunique', 'careerspread_app_id_nunique', 'careerindu_name_nunique', 'net_typetask_id_nunique', 'net_typeadv_id_nunique', 'net_typedev_id_nunique', 'net_typeslot_id_nunique', 'net_typespread_app_id_nunique', 'net_typeindu_name_nunique']
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:07<04:43,  7.46s/it]  5%|▌         | 2/39 [00:13<04:24,  7.14s/it]  8%|▊         | 3/39 [00:20<04:06,  6.84s/it] 10%|█         | 4/39 [00:26<03:54,  6.71s/it] 13%|█▎        | 5/39 [00:33<03:47,  6.70s/it] 15%|█▌        | 6/39 [00:39<03:40,  6.68s/it] 18%|█▊        | 7/39 [00:46<03:33,  6.68s/it] 21%|██        | 8/39 [00:52<03:23,  6.57s/it] 23%|██▎       | 9/39 [00:59<03:16,  6.55s/it] 26%|██▌       | 10/39 [01:05<03:09,  6.53s/it] 28%|██▊       | 11/39 [01:12<03:02,  6.53s/it] 31%|███       | 12/39 [01:18<02:57,  6.58s/it] 33%|███▎      | 13/39 [01:25<02:50,  6.56s/it] 36%|███▌      | 14/39 [01:32<02:45,  6.61s/it] 38%|███▊      | 15/39 [01:38<02:37,  6.55s/it] 41%|████      | 16/39 [01:45<02:31,  6.61s/it] 44%|████▎     | 17/39 [01:51<02:25,  6.60s/it] 46%|████▌     | 18/39 [01:58<02:20,  6.67s/it] 49%|████▊     | 19/39 [02:05<02:13,  6.68s/it] 51%|█████▏    | 20/39 [02:11<02:05,  6.59s/it] 54%|█████▍    | 21/39 [02:18<01:56,  6.47s/it] 56%|█████▋    | 22/39 [02:24<01:48,  6.39s/it] 59%|█████▉    | 23/39 [02:30<01:41,  6.34s/it] 62%|██████▏   | 24/39 [02:37<01:36,  6.42s/it] 64%|██████▍   | 25/39 [02:43<01:29,  6.38s/it] 67%|██████▋   | 26/39 [02:50<01:24,  6.50s/it] 69%|██████▉   | 27/39 [02:56<01:17,  6.47s/it] 72%|███████▏  | 28/39 [03:02<01:10,  6.42s/it] 74%|███████▍  | 29/39 [03:09<01:04,  6.42s/it] 77%|███████▋  | 30/39 [03:15<00:57,  6.41s/it] 79%|███████▉  | 31/39 [03:21<00:50,  6.33s/it] 82%|████████▏ | 32/39 [03:28<00:44,  6.32s/it] 85%|████████▍ | 33/39 [03:34<00:38,  6.40s/it] 87%|████████▋ | 34/39 [03:41<00:32,  6.50s/it] 90%|████████▉ | 35/39 [03:51<00:30,  7.72s/it] 92%|█████████▏| 36/39 [03:58<00:22,  7.43s/it] 95%|█████████▍| 37/39 [04:05<00:14,  7.29s/it] 97%|█████████▋| 38/39 [04:12<00:07,  7.08s/it]100%|██████████| 39/39 [04:18<00:00,  6.89s/it]
111
['adv_id', 'adv_prim_id', 'age', 'app_first_class', 'app_score', 'app_second_class', 'career', 'city', 'city_rank', 'communication_avgonline_30d', 'consume_purchase', 'creat_type_cd', 'dev_id', 'device_name', 'device_price', 'device_size', 'emui_dev', 'gender', 'his_app_size', 'his_on_shelf_time', 'id', 'indu_name', 'inter_type_cd', 'list_time', 'membership_life_duration', 'net_type', 'residence', 'slot_id', 'spread_app_id', 'tags', 'task_id', 'uid', 'up_life_duration', 'up_membership_grade', 'slot_id_count', 'net_type_count', 'task_id_count', 'adv_id_count', 'adv_prim_id_count', 'age_count', 'app_first_class_count', 'app_second_class_count', 'career_count', 'city_count', 'consume_purchase_count', 'uid_count', 'dev_id_count', 'tags_count', 'uidtask_id_nunique', 'uidadv_id_nunique', 'uiddev_id_nunique', 'uidslot_id_nunique', 'uidspread_app_id_nunique', 'uidindu_name_nunique', 'agetask_id_nunique', 'ageadv_id_nunique', 'agedev_id_nunique', 'ageslot_id_nunique', 'agespread_app_id_nunique', 'ageindu_name_nunique', 'careertask_id_nunique', 'careeradv_id_nunique', 'careerdev_id_nunique', 'careerslot_id_nunique', 'careerspread_app_id_nunique', 'careerindu_name_nunique', 'net_typetask_id_nunique', 'net_typeadv_id_nunique', 'net_typedev_id_nunique', 'net_typeslot_id_nunique', 'net_typespread_app_id_nunique', 'net_typeindu_name_nunique', 'uidtask_id_nunique_target_enc', 'uidadv_id_nunique_target_enc', 'uiddev_id_nunique_target_enc', 'uidslot_id_nunique_target_enc', 'uidspread_app_id_nunique_target_enc', 'uidindu_name_nunique_target_enc', 'agetask_id_nunique_target_enc', 'ageadv_id_nunique_target_enc', 'agedev_id_nunique_target_enc', 'ageslot_id_nunique_target_enc', 'agespread_app_id_nunique_target_enc', 'ageindu_name_nunique_target_enc', 'careertask_id_nunique_target_enc', 'careeradv_id_nunique_target_enc', 'careerdev_id_nunique_target_enc', 'careerslot_id_nunique_target_enc', 'careerspread_app_id_nunique_target_enc', 'careerindu_name_nunique_target_enc', 'net_typetask_id_nunique_target_enc', 'net_typeadv_id_nunique_target_enc', 'net_typedev_id_nunique_target_enc', 'net_typeslot_id_nunique_target_enc', 'net_typespread_app_id_nunique_target_enc', 'net_typeindu_name_nunique_target_enc', 'net_type_target_enc', 'task_id_target_enc', 'adv_id_target_enc', 'adv_prim_id_target_enc', 'age_target_enc', 'app_first_class_target_enc', 'app_second_class_target_enc', 'career_target_enc', 'city_target_enc', 'consume_purchase_target_enc', 'uid_target_enc', 'uid_count_target_enc', 'dev_id_target_enc', 'tags_target_enc', 'slot_id_target_enc']
0:	learn: 0.7687781	test: 0.7627289	best: 0.7627289 (0)	total: 103ms	remaining: 17m 14s
50:	learn: 0.7990000	test: 0.7942854	best: 0.7942854 (50)	total: 1.68s	remaining: 5m 27s
100:	learn: 0.8014282	test: 0.7961096	best: 0.7961096 (100)	total: 3.21s	remaining: 5m 14s
150:	learn: 0.8027123	test: 0.7968600	best: 0.7968606 (148)	total: 4.76s	remaining: 5m 10s
200:	learn: 0.8036105	test: 0.7973836	best: 0.7973836 (200)	total: 6.28s	remaining: 5m 6s
250:	learn: 0.8043122	test: 0.7976886	best: 0.7976886 (250)	total: 7.79s	remaining: 5m 2s
300:	learn: 0.8048269	test: 0.7978520	best: 0.7978520 (300)	total: 9.28s	remaining: 4m 58s
350:	learn: 0.8054125	test: 0.7980530	best: 0.7980530 (350)	total: 10.8s	remaining: 4m 55s
400:	learn: 0.8059520	test: 0.7982206	best: 0.7982206 (400)	total: 12.3s	remaining: 4m 53s
450:	learn: 0.8062966	test: 0.7982707	best: 0.7982707 (450)	total: 13.8s	remaining: 4m 51s
500:	learn: 0.8066412	test: 0.7983005	best: 0.7983009 (487)	total: 15.3s	remaining: 4m 49s
550:	learn: 0.8070052	test: 0.7983831	best: 0.7983831 (550)	total: 16.8s	remaining: 4m 47s
600:	learn: 0.8073788	test: 0.7984595	best: 0.7984595 (600)	total: 18.3s	remaining: 4m 46s
650:	learn: 0.8077663	test: 0.7984819	best: 0.7984925 (623)	total: 19.8s	remaining: 4m 44s
700:	learn: 0.8081288	test: 0.7985117	best: 0.7985178 (693)	total: 21.3s	remaining: 4m 42s
750:	learn: 0.8084594	test: 0.7984815	best: 0.7985178 (693)	total: 22.8s	remaining: 4m 40s
800:	learn: 0.8087826	test: 0.7984646	best: 0.7985178 (693)	total: 24.3s	remaining: 4m 38s
850:	learn: 0.8091416	test: 0.7985009	best: 0.7985178 (693)	total: 25.8s	remaining: 4m 36s
bestTest = 0.7985178232
bestIteration = 693
Shrink model to first 694 iterations.
AUC Score (Valid): 0.798518
qt.qpa.screen: QXcbConnection: Could not connect to display localhost:10.0
Could not connect to any X display.
